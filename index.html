<!DOCTYPE html>
<html>

<head>
  <script src="https://accounts.google.com/gsi/client" onload="initClient()" async defer></script>
  <script src="https://apis.google.com/js/api.js" onload="gapiLoad()" async defer></script>
</head>

<body>
  <script>
    var client;
    function initClient() {
      client = google.accounts.oauth2.initTokenClient({
        client_id: '810913561449-r80nc33r20qe18ij2bcll7i6sv4r8bkg.apps.googleusercontent.com',
        scope: 'https://www.googleapis.com/auth/calendar.readonly \
                  https://www.googleapis.com/auth/spreadsheets \
                  https://www.googleapis.com/auth/drive',
        ux_mode: 'popup',
        callback: (response) => {
          console.log(response);
        },
      });
    }
    function getAuthCode() {
      // Request authorization code and obtain user consent
      // Return code to backend.
      // let code = getAuthCode()
      client.requestAccessToken()
    }
    function gapiStart() {
      gapi.client.init({
      }).then(function () {
        gapi.client.load('drive', 'v3');
      }).then(function (response) {
        console.log('discovery document loaded');
      }, function (reason) {
        console.log('Error: ' + reason.result.error.message);
      });
    }

    function gapiLoad() {
      gapi.load('client', gapiStart)
    }

    async function getFiles() {
      let response;
      try {
        response = await gapi.client.drive.files.list({
          'pageSize': 3,
          'fields': 'files(id, name)',
        });
        console.log(response);
      } catch (err) {
        console.log(err);
        return;
      }
    }

    async function createFolder() {
      let file;
      console.log('createFolder')
      const fileMetadata = {
        name: 'Invoices',
        mimeType: 'application/vnd.google-apps.folder',
      };
      try {
        file = gapi.client.drive.files.create({
          resource: fileMetadata,
          fields: 'id',
        });
        console.log(file);
      } catch (err) {
        console.log(err);
        return;
      }
    }

  </script>
  <button onclick="getAuthCode();">Login</button>
  <button onclick="createFolder();">Create Folder</button>
</body>

</html>